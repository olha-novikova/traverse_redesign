(function(){function a(d,c){var e=new b(d,c);return e.beautify()}function b(g,I){var e,M,u,ae,ac,E,ap;var w,J,h;var R,ah,j,s,C,ao;var Z,x;var F;var k,aq;var D,o,B;var d,O,y;var at="";R="\n\r\t ".split("");ah="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split("");ao="0123456789".split("");j="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::";j+=" <%= <% %> <?= <? ?>";j=j.split(" ");C="continue,try,throw,return,var,if,switch,case,default,for,while,break,function".split(",");O={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"};d={TK_START_EXPR:al,TK_END_EXPR:Q,TK_START_BLOCK:aa,TK_END_BLOCK:ab,TK_WORD:A,TK_SEMICOLON:P,TK_STRING:z,TK_EQUALS:U,TK_OPERATOR:af,TK_COMMA:aj,TK_BLOCK_COMMENT:ai,TK_INLINE_COMMENT:Y,TK_COMMENT:p,TK_DOT:ak,TK_UNKNOWN:ad};function l(av,aw){return{mode:aw,last_text:av?av.last_text:"",last_word:av?av.last_word:"",var_line:false,var_line_tainted:false,var_line_reindented:false,in_html_comment:false,multiline_array:false,if_block:false,do_block:false,do_while:false,in_case_statement:false,in_case:false,case_body:false,indentation_level:(av?av.indentation_level+((av.var_line&&av.var_line_reindented)?1:0):0),ternary_depth:0}}I=I?I:{};y={};if(I.space_after_anon_function!==undefined&&I.jslint_happy===undefined){I.jslint_happy=I.space_after_anon_function}if(I.braces_on_own_line!==undefined){y.brace_style=I.braces_on_own_line?"expand":"collapse"}y.brace_style=I.brace_style?I.brace_style:(y.brace_style?y.brace_style:"collapse");if(y.brace_style==="expand-strict"){y.brace_style="expand"}y.indent_size=I.indent_size?parseInt(I.indent_size,10):4;y.indent_char=I.indent_char?I.indent_char:" ";y.preserve_newlines=(I.preserve_newlines===undefined)?true:I.preserve_newlines;y.break_chained_methods=(I.break_chained_methods===undefined)?false:I.break_chained_methods;y.max_preserve_newlines=(I.max_preserve_newlines===undefined)?0:parseInt(I.max_preserve_newlines,10);y.space_in_paren=(I.space_in_paren===undefined)?false:I.space_in_paren;y.jslint_happy=(I.jslint_happy===undefined)?false:I.jslint_happy;y.keep_array_indentation=(I.keep_array_indentation===undefined)?false:I.keep_array_indentation;y.space_before_conditional=(I.space_before_conditional===undefined)?true:I.space_before_conditional;y.unescape_strings=(I.unescape_strings===undefined)?false:I.unescape_strings;y.wrap_line_length=(I.wrap_line_length===undefined)?0:parseInt(I.wrap_line_length,10);y.e4x=(I.e4x===undefined)?false:I.e4x;ap="";while(y.indent_size>0){ap+=y.indent_char;y.indent_size-=1}while(g&&(g.charAt(0)===" "||g.charAt(0)==="\t")){at+=g.charAt(0);g=g.substring(1)}e=g;D=g.length;ac="TK_START_BLOCK";E="";M=[];k=false;aq=false;B=[];h=[];r(O.BlockStatement);s=0;this.beautify=function(){var ax,aw,av,ay;while(true){ax=ag();u=ax[0];ae=ax[1];if(ae==="TK_EOF"){break}av=y.keep_array_indentation&&W(w.mode);if(av){for(aw=0;aw<o;aw+=1){L(true)}}else{F=o>0;if(y.max_preserve_newlines&&o>y.max_preserve_newlines){o=y.max_preserve_newlines}if(y.preserve_newlines){if(o>1){L();for(aw=1;aw<o;aw+=1){L(true)}}}}d[ae]();if(ae!=="TK_INLINE_COMMENT"&&ae!=="TK_COMMENT"&&ae!=="TK_UNKNOWN"){E=w.last_text;ac=ae;w.last_text=u}}ay=at+M.join("").replace(/[\r\n ]+$/,"");return ay};function v(av){av=(av===undefined)?false:av;while(M.length&&(M[M.length-1]===" "||M[M.length-1]===ap||M[M.length-1]===at||(av&&(M[M.length-1]==="\n"||M[M.length-1]==="\r")))){M.pop()}}function c(av){return av.replace(/^\s\s*|\s\s*$/,"")}function an(ax){ax=ax.replace(/\x0d/g,"");var aw=[],av=ax.indexOf("\n");while(av!==-1){aw.push(ax.substring(0,av));ax=ax.substring(av+1);av=ax.indexOf("\n")}if(ax.length){aw.push(ax)}return aw}function au(){return M.length&&M[M.length-1]==="\n"}function m(){return au()&&M.length-1>0&&M[M.length-2]==="\n"}function H(av,ax){var aw=av.length-1;if(aw<0){aw+=av.length}if(aw>av.length-1){aw=av.length-1}for(aw++;aw-->0;){if(aw in av&&av[aw]===ax){return aw}}return -1}function q(ax){ax=(ax===undefined)?false:ax;if(y.wrap_line_length&&!ax){var av="";var aw=0;var ay=H(M,"\n")+1;if(ay<M.length){av=M.slice(ay).join("");aw=av.length+u.length+(aq?1:0);if(aw>=y.wrap_line_length){ax=true}}}if(((y.preserve_newlines&&F)||ax)&&!au()){L(false,true);k=true;F=false}}function L(av,aw){k=false;aq=false;if(!aw){if(w.last_text!==";"){while(w.mode===O.Statement&&!w.if_block){i()}}}if(w.mode===O.ArrayLiteral){w.multiline_array=true}if(!M.length){return}if(av||!au()){M.push("\n")}}function G(){if(au()){if(y.keep_array_indentation&&W(w.mode)&&B.length){M.push(B.join("")+"")}else{if(at){M.push(at)}n(w.indentation_level);n(w.var_line&&w.var_line_reindented);n(k)}}}function n(aw){if(aw===undefined){aw=1}else{if(typeof aw!=="number"){aw=aw?1:0}}if(w.last_text!==""){for(var av=0;av<aw;av+=1){M.push(ap)}}}function am(){if(aq&&M.length){var av=M[M.length-1];if(!au()&&av!==" "&&av!==ap){M.push(" ")}}}function S(av){av=av||u;G();k=false;am();aq=false;M.push(av)}function t(){w.indentation_level+=1}function r(av){if(w){h.push(w);J=w}else{J=l(null,av)}w=l(J,av)}function W(av){return av===O.ArrayLiteral}function N(av){return T(av,[O.Expression,O.ForInitializer,O.Conditional])}function i(){if(h.length>0){J=w;w=h.pop()}}function K(){if((w.last_text==="do"||(w.last_text==="else"&&u!=="if")||(ac==="TK_END_EXPR"&&(J.mode===O.ForInitializer||J.mode===O.Conditional)))){q();r(O.Statement);t();k=false;return true}return false}function ar(aw,ay){for(var ax=0;ax<aw.length;ax++){var av=c(aw[ax]);if(av.charAt(0)!==ay){return false}}return true}function V(av){return T(av,["case","return","do","if","throw","else"])}function T(ax,av){for(var aw=0;aw<av.length;aw+=1){if(av[aw]===ax){return true}}return false}function f(ay){var av=false,aw="",aB=0,ax="",az=0,aA;while(av||aB<ay.length){aA=ay.charAt(aB);aB++;if(av){av=false;if(aA==="x"){ax=ay.substr(aB,2);aB+=2}else{if(aA==="u"){ax=ay.substr(aB,4);aB+=4}else{aw+="\\"+aA;continue}}if(!ax.match(/^[0123456789abcdefABCDEF]+$/)){return ay}az=parseInt(ax,16);if(az>=0&&az<32){if(aA==="x"){aw+="\\x"+ax}else{aw+="\\u"+ax}continue}else{if(az===34||az===39||az===92){aw+="\\"+String.fromCharCode(az)}else{if(aA==="x"&&az>126&&az<=255){return ay}else{aw+=String.fromCharCode(az)}}}}else{if(aA==="\\"){av=true}else{aw+=aA}}}return aw}function X(aw){var av=s;var ax=e.charAt(av);while(T(ax,R)&&ax!==aw){av++;if(av>=D){return false}ax=e.charAt(av)}return ax===aw}function ag(){var aH,aG;o=0;if(s>=D){return["","TK_EOF"]}F=false;B=[];var aM=e.charAt(s);s+=1;while(T(aM,R)){if(aM==="\n"){o+=1;B=[]}else{if(o){if(aM===ap){B.push(ap)}else{if(aM!=="\r"){B.push(" ")}}}}if(s>=D){return["","TK_EOF"]}aM=e.charAt(s);s+=1}if(T(aM,ah)){if(s<D){while(T(e.charAt(s),ah)){aM+=e.charAt(s);s+=1;if(s===D){break}}}if(s!==D&&aM.match(/^[0-9]+[Ee]$/)&&(e.charAt(s)==="-"||e.charAt(s)==="+")){var aO=e.charAt(s);s+=1;var aD=ag();aM+=aO+aD[0];return[aM,"TK_WORD"]}if(aM==="in"){return[aM,"TK_OPERATOR"]}return[aM,"TK_WORD"]}if(aM==="("||aM==="["){return[aM,"TK_START_EXPR"]}if(aM===")"||aM==="]"){return[aM,"TK_END_EXPR"]}if(aM==="{"){return[aM,"TK_START_BLOCK"]}if(aM==="}"){return[aM,"TK_END_BLOCK"]}if(aM===";"){return[aM,"TK_SEMICOLON"]}if(aM==="/"){var aw="";var aE=true;if(e.charAt(s)==="*"){s+=1;if(s<D){while(s<D&&!(e.charAt(s)==="*"&&e.charAt(s+1)&&e.charAt(s+1)==="/")){aM=e.charAt(s);aw+=aM;if(aM==="\n"||aM==="\r"){aE=false}s+=1;if(s>=D){break}}}s+=2;if(aE&&o===0){return["/*"+aw+"*/","TK_INLINE_COMMENT"]}else{return["/*"+aw+"*/","TK_BLOCK_COMMENT"]}}if(e.charAt(s)==="/"){aw=aM;while(e.charAt(s)!=="\r"&&e.charAt(s)!=="\n"){aw+=e.charAt(s);s+=1;if(s>=D){break}}return[aw,"TK_COMMENT"]}}if(aM==="'"||aM==='"'||((aM==="/")||(y.e4x&&aM==="<"&&e.slice(s-1).match(/^<[a-zA-Z:0-9]+\s*([a-zA-Z:0-9]+="[^"]*"\s*)*\/?\s*>/)))&&((ac==="TK_WORD"&&V(w.last_text))||(ac==="TK_END_EXPR"&&T(J.mode,[O.Conditional,O.ForInitializer]))||(T(ac,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"])))){var aF=aM,aN=false,ay=false;aG=aM;if(s<D){if(aF==="/"){var az=false;while(aN||az||e.charAt(s)!==aF){aG+=e.charAt(s);if(!aN){aN=e.charAt(s)==="\\";if(e.charAt(s)==="["){az=true}else{if(e.charAt(s)==="]"){az=false}}}else{aN=false}s+=1;if(s>=D){return[aG,"TK_STRING"]}}}else{if(y.e4x&&aF==="<"){var aL=/<(\/?)([a-zA-Z:0-9]+)\s*([a-zA-Z:0-9]+="[^"]*"\s*)*(\/?)\s*>/g;var ax=e.slice(s-1);var aB=aL.exec(ax);if(aB&&aB.index===0){var aJ=aB[2];var aP=0;while(aB){var aK=!!aB[1];var aA=aB[2];var av=!!aB[aB.length-1];if(aA===aJ&&!av){if(aK){--aP}else{++aP}}if(aP<=0){break}aB=aL.exec(ax)}var aI=aB?aB.index+aB[0].length:ax.length;s+=aI-1;return[ax.slice(0,aI),"TK_STRING"]}}else{while(aN||e.charAt(s)!==aF){aG+=e.charAt(s);if(aN){if(e.charAt(s)==="x"||e.charAt(s)==="u"){ay=true}aN=false}else{aN=e.charAt(s)==="\\"}s+=1;if(s>=D){return[aG,"TK_STRING"]}}}}}s+=1;aG+=aF;if(ay&&y.unescape_strings){aG=f(aG)}if(aF==="/"){while(s<D&&T(e.charAt(s),ah)){aG+=e.charAt(s);s+=1}}return[aG,"TK_STRING"]}if(aM==="#"){if(M.length===0&&e.charAt(s)==="!"){aG=aM;while(s<D&&aM!=="\n"){aM=e.charAt(s);aG+=aM;s+=1}return[c(aG)+"\n","TK_UNKNOWN"]}var aC="#";if(s<D&&T(e.charAt(s),ao)){do{aM=e.charAt(s);aC+=aM;s+=1}while(s<D&&aM!=="#"&&aM!=="=");if(aM==="#"){}else{if(e.charAt(s)==="["&&e.charAt(s+1)==="]"){aC+="[]";s+=2}else{if(e.charAt(s)==="{"&&e.charAt(s+1)==="}"){aC+="{}";s+=2}}}return[aC,"TK_WORD"]}}if(aM==="<"&&e.substring(s-1,s+3)==="<!--"){s+=3;aM="<!--";while(e.charAt(s)!=="\n"&&s<D){aM+=e.charAt(s);s++}w.in_html_comment=true;return[aM,"TK_COMMENT"]}if(aM==="-"&&w.in_html_comment&&e.substring(s-1,s+2)==="-->"){w.in_html_comment=false;s+=2;return["-->","TK_COMMENT"]}if(aM==="."){return[aM,"TK_DOT"]}if(T(aM,j)){while(s<D&&T(aM+e.charAt(s),j)){aM+=e.charAt(s);s+=1;if(s>=D){break}}if(aM===","){return[aM,"TK_COMMA"]}else{if(aM==="="){return[aM,"TK_EQUALS"]}else{return[aM,"TK_OPERATOR"]}}}return[aM,"TK_UNKNOWN"]}function al(){if(K()){}if(u==="["){if(ac==="TK_WORD"||w.last_text===")"){if(T(w.last_text,C)){aq=true}r(O.Expression);S();if(y.space_in_paren){aq=true}return}if(W(w.mode)){if(w.last_text==="["||(w.last_text===","&&(E==="]"||E==="}"))){if(!y.keep_array_indentation){L()}}}}else{if(w.last_text==="for"){r(O.ForInitializer)}else{if(T(w.last_text,["if","while"])){r(O.Conditional)}else{r(O.Expression)}}}if(w.last_text===";"||ac==="TK_START_BLOCK"){L()}else{if(ac==="TK_END_EXPR"||ac==="TK_START_EXPR"||ac==="TK_END_BLOCK"||w.last_text==="."){if(F){L()}}else{if(ac!=="TK_WORD"&&ac!=="TK_OPERATOR"){aq=true}else{if(w.last_word==="function"||w.last_word==="typeof"){if(y.jslint_happy){aq=true}}else{if(T(w.last_text,C)||w.last_text==="catch"){if(y.space_before_conditional){aq=true}}}}}}if(u==="("){if(ac==="TK_EQUALS"||ac==="TK_OPERATOR"){if(w.mode!==O.ObjectLiteral){q()}}}S();if(y.space_in_paren){aq=true}if(u==="["){r(O.ArrayLiteral);t()}if(x){x=false;t()}}function Q(){while(w.mode===O.Statement){i()}if(u==="]"&&W(w.mode)&&w.multiline_array&&!y.keep_array_indentation){L()}i();if(y.space_in_paren){aq=true}S();if(w.do_while&&J.mode===O.Conditional){J.mode=O.Expression;w.do_block=false;w.do_while=false}}function aa(){r(O.BlockStatement);var aw=X("}");var av=aw&&w.last_word==="function"&&ac==="TK_END_EXPR";if(y.brace_style==="expand"){if(ac!=="TK_OPERATOR"&&(av||ac==="TK_EQUALS"||(V(w.last_text)&&w.last_text!=="else"))){aq=true}else{L()}}else{if(ac!=="TK_OPERATOR"&&ac!=="TK_START_EXPR"){if(ac==="TK_START_BLOCK"){L()}else{aq=true}}else{if(W(J.mode)&&w.last_text===","){if(E==="}"){aq=true}else{L()}}}}S();t()}function ab(){while(w.mode===O.Statement){i()}i();var av=ac==="TK_START_BLOCK";if(y.brace_style==="expand"){if(!av){L()}}else{if(!av){if(W(w.mode)&&y.keep_array_indentation){y.keep_array_indentation=false;L();y.keep_array_indentation=true}else{L()}}}S()}function A(){if(K()){}else{if(F&&!N(w.mode)&&(ac!=="TK_OPERATOR"||(w.last_text==="--"||w.last_text==="++"))&&ac!=="TK_EQUALS"&&(y.preserve_newlines||w.last_text!=="var")){L()}}if(w.do_block&&!w.do_while){if(u==="while"){aq=true;S();aq=true;w.do_while=true;return}else{L();w.do_block=false}}if(x&&V(u)){x=false}if(w.if_block){if(u!=="else"){while(w.mode===O.Statement){i()}w.if_block=false}}if(u==="function"){if(w.var_line&&ac!=="TK_EQUALS"){w.var_line_reindented=true}if((au()||w.last_text===";"||w.last_text==="}")&&w.last_text!=="{"&&!W(w.mode)){if(!au()){L(true)}if(!m()){L(true)}}if(ac==="TK_WORD"){if(w.last_text==="get"||w.last_text==="set"||w.last_text==="new"||w.last_text==="return"){aq=true}else{L()}}else{if(ac==="TK_OPERATOR"||w.last_text==="="){aq=true}else{if(N(w.mode)){}else{L()}}}S();w.last_word=u;return}if(u==="case"||(u==="default"&&w.in_case_statement)){L();if(w.case_body||y.jslint_happy){w.indentation_level--;w.case_body=false}S();w.in_case=true;w.in_case_statement=true;return}Z="NONE";if(ac==="TK_END_BLOCK"){if(!T(u,["else","catch","finally"])){Z="NEWLINE"}else{if(y.brace_style==="expand"||y.brace_style==="end-expand"){Z="NEWLINE"}else{Z="SPACE";aq=true}}}else{if(ac==="TK_SEMICOLON"&&w.mode===O.BlockStatement){Z="NEWLINE"}else{if(ac==="TK_SEMICOLON"&&N(w.mode)){Z="SPACE"}else{if(ac==="TK_STRING"){Z="NEWLINE"}else{if(ac==="TK_WORD"){Z="SPACE"}else{if(ac==="TK_START_BLOCK"){Z="NEWLINE"}else{if(ac==="TK_END_EXPR"){aq=true;Z="NEWLINE"}}}}}}}if(T(u,C)&&w.last_text!==")"){if(w.last_text==="else"){Z="SPACE"}else{Z="NEWLINE"}}if(ac==="TK_COMMA"||ac==="TK_START_EXPR"||ac==="TK_EQUALS"||ac==="TK_OPERATOR"){if(w.mode!==O.ObjectLiteral){q()}}if(T(u,["else","catch","finally"])){if(ac!=="TK_END_BLOCK"||y.brace_style==="expand"||y.brace_style==="end-expand"){L()}else{v(true);if(M[M.length-1]!=="}"){L()}aq=true}}else{if(Z==="NEWLINE"){if(V(w.last_text)){aq=true}else{if(ac!=="TK_END_EXPR"){if((ac!=="TK_START_EXPR"||u!=="var")&&w.last_text!==":"){if(u==="if"&&w.last_word==="else"&&w.last_text!=="{"){aq=true}else{w.var_line=false;w.var_line_reindented=false;L()}}}else{if(T(u,C)&&w.last_text!==")"){w.var_line=false;w.var_line_reindented=false;L()}}}}else{if(W(w.mode)&&w.last_text===","&&E==="}"){L()}else{if(Z==="SPACE"){aq=true}}}}S();w.last_word=u;if(u==="var"){w.var_line=true;w.var_line_reindented=false;w.var_line_tainted=false}if(u==="do"){w.do_block=true}if(u==="if"){w.if_block=true}}function P(){while(w.mode===O.Statement&&!w.if_block){i()}S();w.var_line=false;w.var_line_reindented=false;if(w.mode===O.ObjectLiteral){w.mode=O.BlockStatement}}function z(){if(K()){aq=true}else{if(ac==="TK_WORD"){aq=true}else{if(ac==="TK_COMMA"||ac==="TK_START_EXPR"||ac==="TK_EQUALS"||ac==="TK_OPERATOR"){if(w.mode!==O.ObjectLiteral){q()}}else{L()}}}S()}function U(){if(w.var_line){w.var_line_tainted=true}aq=true;S();aq=true}function aj(){if(w.var_line){if(N(w.mode)||ac==="TK_END_BLOCK"){w.var_line_tainted=false}if(w.var_line){w.var_line_reindented=true}S();if(w.var_line_tainted){w.var_line_tainted=false;L()}else{aq=true}return}if(ac==="TK_END_BLOCK"&&w.mode!==O.Expression){S();if(w.mode===O.ObjectLiteral&&w.last_text==="}"){L()}else{aq=true}}else{if(w.mode===O.ObjectLiteral){S();L()}else{S();aq=true}}}function af(){var aw=true;var av=true;if(V(w.last_text)){aq=true;S();return}if(u==="*"&&ac==="TK_DOT"&&!E.match(/^\d+$/)){S();return}if(u===":"&&w.in_case){w.case_body=true;t();S();L();w.in_case=false;return}if(u==="::"){S();return}if(F&&(u==="--"||u==="++")){L()}if(T(u,["--","++","!"])||(T(u,["-","+"])&&(T(ac,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||T(w.last_text,C)||w.last_text===","))){aw=false;av=false;if(w.last_text===";"&&N(w.mode)){aw=true}if(ac==="TK_WORD"&&T(w.last_text,C)){aw=true}if((w.mode===O.BlockStatement||w.mode===O.Statement)&&(w.last_text==="{"||w.last_text===";")){L()}}else{if(u===":"){if(w.ternary_depth===0){if(w.mode===O.BlockStatement){w.mode=O.ObjectLiteral}aw=false}else{w.ternary_depth-=1}}else{if(u==="?"){w.ternary_depth+=1}}}aq=aq||aw;S();aq=av}function ai(){var av=an(u);var aw;if(ar(av.slice(1),"*")){L(false,true);S(av[0]);for(aw=1;aw<av.length;aw++){L(false,true);S(" "+c(av[aw]))}}else{if(av.length>1){L(false,true)}else{if(ac==="TK_END_BLOCK"){L(false,true)}else{aq=true}}S(av[0]);M.push("\n");for(aw=1;aw<av.length;aw++){M.push(av[aw]);M.push("\n")}}if(!X("\n")){L(false,true)}}function Y(){aq=true;S();aq=true}function p(){if(F){L(false,true)}else{v(true)}aq=true;S();L(false,true)}function ak(){if(V(w.last_text)){aq=true}else{q(w.last_text===")"&&y.break_chained_methods)}if(au()){x=true}S()}function ad(){S();if(u[u.length-1]==="\n"){L()}}}if(typeof define==="function"){define(function(d,c,e){c.js_beautify=a})}else{if(typeof exports!=="undefined"){exports.js_beautify=a}else{if(typeof window!=="undefined"){window.js_beautify=a}else{if(typeof global!=="undefined"){global.js_beautify=a}}}}}());(function(){function b(v,g,p,h){var z,s,q,j,k,y;g=g||{};s=g.indent_size||4;q=g.indent_char||" ";k=g.brace_style||"collapse";j=g.max_char===0?Infinity:g.max_char||250;y=g.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"];function f(){this.pos=0;this.token="";this.current_mode="CONTENT";this.tags={parent:"parent1",parentcount:1,parent1:""};this.tag_type="";this.token_text=this.last_token=this.last_text=this.token_type="";this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(B,t){for(var A=0;A<t.length;A++){if(B===t[A]){return true}}return false}};this.get_content=function(){var t="",B=[],C=false;while(this.input.charAt(this.pos)!=="<"){if(this.pos>=this.input.length){return B.length?B.join(""):["","TK_EOF"]}t=this.input.charAt(this.pos);this.pos++;this.line_char_count++;if(this.Utils.in_array(t,this.Utils.whitespace)){if(B.length){C=true}this.line_char_count--;continue}else{if(C){if(this.line_char_count>=this.max_char){B.push("\n");for(var A=0;A<this.indent_level;A++){B.push(this.indent_string)}this.line_char_count=0}else{B.push(" ");this.line_char_count++}C=false}}B.push(t)}return B.length?B.join(""):""};this.get_contents_to=function(B){if(this.pos===this.input.length){return["","TK_EOF"]}var t="";var C="";var D=new RegExp("</"+B+"\\s*>","igm");D.lastIndex=this.pos;var A=D.exec(this.input);var E=A?A.index:this.input.length;if(this.pos<E){C=this.input.substring(this.pos,E);this.pos=E}return C};this.record_tag=function(t){if(this.tags[t+"count"]){this.tags[t+"count"]++;this.tags[t+this.tags[t+"count"]]=this.indent_level}else{this.tags[t+"count"]=1;this.tags[t+this.tags[t+"count"]]=this.indent_level}this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent;this.tags.parent=t+this.tags[t+"count"]};this.retrieve_tag=function(t){if(this.tags[t+"count"]){var A=this.tags.parent;while(A){if(t+this.tags[t+"count"]===A){break}A=this.tags[A+"parent"]}if(A){this.indent_level=this.tags[t+this.tags[t+"count"]];this.tags.parent=this.tags[A+"parent"]}delete this.tags[t+this.tags[t+"count"]+"parent"];delete this.tags[t+this.tags[t+"count"]];if(this.tags[t+"count"]===1){delete this.tags[t+"count"]}else{this.tags[t+"count"]--}}};this.get_tag=function(J){var E="",G=[],F="",A=false,I,D,B=this.pos,t=this.line_char_count;J=J!==undefined?J:false;do{if(this.pos>=this.input.length){if(J){this.pos=B;this.line_char_count=t}return G.length?G.join(""):["","TK_EOF"]}E=this.input.charAt(this.pos);this.pos++;this.line_char_count++;if(this.Utils.in_array(E,this.Utils.whitespace)){A=true;this.line_char_count--;continue}if(E==="'"||E==='"'){if(!G[1]||G[1]!=="!"){E+=this.get_unformatted(E);A=true}}if(E==="="){A=false}if(G.length&&G[G.length-1]!=="="&&E!==">"&&A){if(this.line_char_count>=this.max_char){this.print_newline(false,G);this.line_char_count=0}else{G.push(" ");this.line_char_count++}A=false}if(E==="<"){I=this.pos-1}G.push(E)}while(E!==">");var K=G.join("");var C;if(K.indexOf(" ")!==-1){C=K.indexOf(" ")}else{C=K.indexOf(">")}var H=K.substring(1,C).toLowerCase();if(K.charAt(K.length-2)==="/"||this.Utils.in_array(H,this.Utils.single_token)){if(!J){this.tag_type="SINGLE"}}else{if(H==="script"){if(!J){this.record_tag(H);this.tag_type="SCRIPT"}}else{if(H==="style"){if(!J){this.record_tag(H);this.tag_type="STYLE"}}else{if(this.is_unformatted(H,y)){F=this.get_unformatted("</"+H+">",K);G.push(F);if(I>0&&this.Utils.in_array(this.input.charAt(I-1),this.Utils.whitespace)){G.splice(0,0,this.input.charAt(I-1))}D=this.pos-1;if(this.Utils.in_array(this.input.charAt(D+1),this.Utils.whitespace)){G.push(this.input.charAt(D+1))}this.tag_type="SINGLE"}else{if(H.charAt(0)==="!"){if(H.indexOf("[if")!==-1){if(K.indexOf("!IE")!==-1){F=this.get_unformatted("-->",K);G.push(F)}if(!J){this.tag_type="START"}}else{if(H.indexOf("[endif")!==-1){this.tag_type="END";this.unindent()}else{if(H.indexOf("[cdata[")!==-1){F=this.get_unformatted("]]>",K);G.push(F);if(!J){this.tag_type="SINGLE"}}else{F=this.get_unformatted("-->",K);G.push(F);this.tag_type="SINGLE"}}}}else{if(!J){if(H.charAt(0)==="/"){this.retrieve_tag(H.substring(1));this.tag_type="END"}else{this.record_tag(H);this.tag_type="START"}if(this.Utils.in_array(H,this.Utils.extra_liners)){this.print_newline(true,this.output)}}}}}}}if(J){this.pos=B;this.line_char_count=t}return G.join("")};this.get_unformatted=function(A,B){if(B&&B.toLowerCase().indexOf(A)!==-1){return""}var t="";var C="";var D=true;do{if(this.pos>=this.input.length){return C}t=this.input.charAt(this.pos);this.pos++;if(this.Utils.in_array(t,this.Utils.whitespace)){if(!D){this.line_char_count--;continue}if(t==="\n"||t==="\r"){C+="\n";this.line_char_count=0;continue}}C+=t;this.line_char_count++;D=true}while(C.toLowerCase().indexOf(A)===-1);return C};this.get_token=function(){var t;if(this.last_token==="TK_TAG_SCRIPT"||this.last_token==="TK_TAG_STYLE"){var A=this.last_token.substr(7);t=this.get_contents_to(A);if(typeof t!=="string"){return t}return[t,"TK_"+A]}if(this.current_mode==="CONTENT"){t=this.get_content();if(typeof t!=="string"){return t}else{return[t,"TK_CONTENT"]}}if(this.current_mode==="TAG"){t=this.get_tag();if(typeof t!=="string"){return t}else{var B="TK_TAG_"+this.tag_type;return[t,B]}}};this.get_full_indent=function(t){t=this.indent_level+t||0;if(t<1){return""}return Array(t+1).join(this.indent_string)};this.is_unformatted=function(B,A){if(!this.Utils.in_array(B,A)){return false}if(B.toLowerCase()!=="a"||!this.Utils.in_array("a",A)){return true}var C=this.get_tag(true);var t=(C||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);if(!t||this.Utils.in_array(t,A)){return true}else{return false}};this.printer=function(C,B,t,E,D){this.input=C||"";this.output=[];this.indent_character=B;this.indent_string="";this.indent_size=t;this.brace_style=D;this.indent_level=0;this.max_char=E;this.line_char_count=0;for(var A=0;A<this.indent_size;A++){this.indent_string+=this.indent_character}this.print_newline=function(H,F){this.line_char_count=0;if(!F||!F.length){return}if(!H){while(this.Utils.in_array(F[F.length-1],this.Utils.whitespace)){F.pop()}}F.push("\n");for(var G=0;G<this.indent_level;G++){F.push(this.indent_string)}};this.print_token=function(F){this.output.push(F)};this.indent=function(){this.indent_level++};this.unindent=function(){if(this.indent_level>0){this.indent_level--}}};return this}z=new f();z.printer(v,q,s,j,k);while(true){var m=z.get_token();z.token_text=m[0];z.token_type=m[1];if(z.token_type==="TK_EOF"){break}switch(z.token_type){case"TK_TAG_START":z.print_newline(false,z.output);z.print_token(z.token_text);z.indent();z.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":z.print_newline(false,z.output);z.print_token(z.token_text);z.current_mode="CONTENT";break;case"TK_TAG_END":if(z.last_token==="TK_CONTENT"&&z.last_text===""){var x=z.token_text.match(/\w+/)[0];var o=z.output[z.output.length-1].match(/<\s*(\w+)/);if(o===null||o[1]!==x){z.print_newline(true,z.output)}}z.print_token(z.token_text);z.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var e=z.token_text.match(/^\s*<([a-z]+)/i);if(!e||!z.Utils.in_array(e[1],y)){z.print_newline(false,z.output)}z.print_token(z.token_text);z.current_mode="CONTENT";break;case"TK_CONTENT":if(z.token_text!==""){z.print_token(z.token_text)}z.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(z.token_text!==""){z.output.push("\n");var n=z.token_text,u,l=1;if(z.token_type==="TK_SCRIPT"){u=typeof p==="function"&&p}else{if(z.token_type==="TK_STYLE"){u=typeof h==="function"&&h}}if(g.indent_scripts==="keep"){l=0}else{if(g.indent_scripts==="separate"){l=-z.indent_level}}var d=z.get_full_indent(l);if(u){n=u(n.replace(/^\s*/,d),g)}else{var i=n.match(/^\s*/)[0];var r=i.match(/[^\n\r]*$/)[0].split(z.indent_string).length-1;var w=z.get_full_indent(l-r);n=n.replace(/^\s*/,d).replace(/\r\n|\r|\n/g,"\n"+w).replace(/\s*$/,"")}if(n){z.print_token(n);z.print_newline(true,z.output)}}z.current_mode="TAG";break}z.last_token=z.token_type;z.last_text=z.token_text}return z.output.join("")}if(typeof define==="function"){define(function(f,e,g){var d=f("./beautify.js").js_beautify;var h=f("./beautify-css.js").css_beautify;e.html_beautify=function(j,i){return b(j,i,d,h)}})}else{if(typeof exports!=="undefined"){var a=require("./beautify.js").js_beautify;var c=require("./beautify-css.js").css_beautify;exports.html_beautify=function(e,d){return b(e,d,a,c)}}else{if(typeof window!=="undefined"){window.html_beautify=function(e,d){return b(e,d,window.js_beautify,window.css_beautify)}}else{if(typeof global!=="undefined"){global.html_beautify=function(e,d){return b(e,d,global.js_beautify,global.css_beautify)}}}}}}());